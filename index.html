<html>
<head>
	<title>Game 2D</title>
	<style>
		body {
			margin: 0;
			padding: 0;
			background-color: #000000;
		}
	</style>
	<link href='http://fonts.googleapis.com/css?family=Freckle+Face' rel='stylesheet' type='text/css'>
	<script type="text/javascript" src="assets/scripts/pixi/pixi.js"></script>

	<script type="text/javascript" src="assets/scripts/jquery/jquery-1.10.2.min.js"></script>

	<script type="text/javascript" src="assets/scripts/stats/stats.min.js"></script>

	<script type="text/javascript" src="assets/scripts/tween/jquery.gsap.min.js"></script>
	<script type="text/javascript" src="assets/scripts/tween/TimelineLite.min.js"></script>
	<script type="text/javascript" src="assets/scripts/tween/TimelineMax.min.js"></script>
	<script type="text/javascript" src="assets/scripts/tween/TweenLite.min.js"></script>
	<script type="text/javascript" src="assets/scripts/tween/TweenMax.min.js"></script>
	<script type="text/javascript" src="assets/scripts/tween/easing/EasePack.min.js"></script>

	<script type="text/javascript" src="assets/scripts/pathfinding/pathfinding-browser.min.js"></script>

	<script type="text/javascript" src="assets/scripts/input.class.js"></script>

	<script type="text/javascript" src="assets/scripts/directions.enum.js"></script>
	<script type="text/javascript" src="assets/scripts/cursors.enum.js"></script>

	<script type="text/javascript" src="assets/scripts/point.class.js"></script>

	<script type="text/javascript" src="assets/scripts/pointlight.class.js"></script>
	<script type="text/javascript" src="assets/scripts/gui.class.js"></script>	

	<script type="text/javascript" src="assets/scripts/game.class.js"></script>
	<script type="text/javascript" src="assets/scripts/action.class.js"></script>
	<script type="text/javascript" src="assets/scripts/map.class.js"></script>
	<script type="text/javascript" src="assets/scripts/camera.class.js"></script>
	<script type="text/javascript" src="assets/scripts/tile.class.js"></script>
	<script type="text/javascript" src="assets/scripts/creature.class.js"></script>
	<script type="text/javascript" src="assets/scripts/player.class.js"></script>
	<script type="text/javascript" src="assets/scripts/monster.class.js"></script>
</head>
<body>
	<script>
		// STATS
		var stats = new Stats();
		stats.setMode(0); // 0: fps, 1: ms
		stats.domElement.style.position = 'absolute';
		stats.domElement.style.left = '0px';
		stats.domElement.style.top = '0px';
		document.body.appendChild(stats.domElement);

		Game.initialize();

		var label = new PIXI.Text('null', { font: '14px Arial', fill: '#FFFFFF' });
		label.anchor = new PIXI.Point(0.5, 2.5);

		var pointLight;

		Map.load('assets/maps/test-1.json', function() {
			// Instantiate player
			var player = new Player({
				name: 'Mukah',
				texture: PIXI.Texture.fromImage('assets/creatures/player.png'),
				health: {
					now: 100,
					max: 100
				},
				onMove: function() {
					label.position = player.view.position;
					camera1.centerAt(player.view.position).focus();
				}
			});
			player.setPosition(3, 3);
			Game.protagonist = player;
			Game.viewport.addChild(player.view);

			// Player name label
			label.setText(player.name);
			Game.viewport.addChild(label);			

			// Testing GUI button
			var bt = new GUIButton({
				textures: {
					normal: Map.tiles[5].texture,
					over: Map.tiles[10].texture
				},
				onClick: function() {
					Game.protagonist.walkTo(new PIXI.Point(49,49));
				}
			});
			bt.setPosition(new PIXI.Point(100, 100));
			Game.stage.addChild(bt.view);

			// Light point
			pointLight = new PointLight({
				color: 0xFDE69A,
				intensity: 0.7
			});
			pointLight.setPosition(new PIXI.Point(32*5, 32*5));
			Game.viewport.addChild(pointLight.view);

			// Map alpha tween
			TweenLite.to(Game.mapContainer, 1, {
				alpha: 1,
				ease: Linear.easeNone,
				onComplete: function(){
					console.log('Animation finished.');
				}
			});
		});

		var camera1 = new Camera();
		camera1.centerAt(new PIXI.Point(500, 500));

		var camera2 = new Camera();
		camera2.centerAt(new PIXI.Point(1600, 1600));

		Game.onUpdate = function() {
			// O update Ã© executado antes do player ser instanciado.
			if(Game.protagonist.status == STATUS.IDLE) {
				if(Input.isDown(Input.KEY_DOWN)) {
					Game.protagonist.move(DIRECTIONS.DOWN);
				} else if(Input.isDown(Input.KEY_UP)) {
					Game.protagonist.move(DIRECTIONS.UP);
				} else if(Input.isDown(Input.KEY_LEFT)) {
					Game.protagonist.move(DIRECTIONS.LEFT);
				} else if(Input.isDown(Input.KEY_RIGHT)) {
					Game.protagonist.move(DIRECTIONS.RIGHT);
				}
			}
		};
	</script>
	</body>
</html>